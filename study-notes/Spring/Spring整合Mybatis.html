<html>
<head>
  <title>Spring整合Mybatis</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/602916 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="2730"/>
<h1>Spring整合Mybatis</h1>

<div>
<span><div>把mybatis和spring集成在一起，像一个框架一样使用。</div><div>    用的技术是：ioc；</div><div>为什么ioc可以把mybatis和spring集成在一起？</div><div>    因为ioc可以创建对象，可以把mybatis框架中的对象交给spring统一创建，开发人员从spring中获取对象。</div><div><img src="Spring整合Mybatis_files/Image.png" type="image/png" data-filename="Image.png"/></div><div>Spring整合Mybatis</div><div>开发步骤：</div><div><img src="Spring整合Mybatis_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div><img src="Spring整合Mybatis_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>加入依赖</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>&lt;!--Spring依赖--&gt;</div><div>&lt;dependency&gt;</div><div>    &lt;groupId&gt;org.springframework&lt;/groupId&gt;</div><div>    &lt;artifactId&gt;spring-context&lt;/artifactId&gt;    </div><div>    &lt;version&gt;5.2.5.RELEASE&lt;/version&gt;</div><div>&lt;/dependency&gt;</div><div>&lt;!--事务依赖--&gt;</div><div>&lt;dependency&gt;</div><div>    &lt;groupId&gt;org.springframework&lt;/groupId&gt;</div><div>    &lt;artifactId&gt;spring-tx&lt;/artifactId&gt;    </div><div>    &lt;version&gt;5.2.5.RELEASE&lt;/version&gt;</div><div>&lt;/dependency&gt;</div><div>&lt;dependency&gt;</div><div>    &lt;groupId&gt;org.springframework&lt;/groupId&gt;</div><div>    &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt;    </div><div>    &lt;version&gt;5.2.5.RELEASE&lt;/version&gt;</div><div>&lt;/dependency&gt;</div><div>&lt;!--Mybatis和spring集成的依赖--&gt;</div><div>&lt;dependency&gt;</div><div>    &lt;groupId&gt;org.mybatis&lt;/groupId&gt;</div><div>    &lt;artifactId&gt;mybatis-spring&lt;/artifactId&gt;    </div><div>    &lt;version&gt;1.3.1&lt;/version&gt;</div><div>&lt;/dependency&gt;</div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">&lt;!--mysql驱动--&gt;</span></div><div>&lt;dependency&gt;</div><div>    &lt;groupId&gt;mysql&lt;/groupId&gt;</div><div>    &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;    </div><div>    &lt;version&gt;5.1.9&lt;/version&gt;</div><div>&lt;/dependency&gt;</div><div>&lt;!--阿里公司的数据库连接池--&gt;</div><div>&lt;dependency&gt;</div><div>    &lt;groupId&gt;com.alibaba&lt;/groupId&gt;</div><div>    &lt;artifactId&gt;druid&lt;/artifactId&gt;    </div><div>    &lt;version&gt;1.1.12&lt;/version&gt;</div><div>&lt;/dependency&gt;</div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>mybatis主配置文件</div><div><br/></div></div><div><br/></div><div>创建spring的配置文件：声明mybatis的对象交给spring对象创建</div><div>1&gt;数据源DataSource（通过spring创建druid连接池）</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>github 官网</div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">&lt;!--声明数据源，作用是连接数据库的--&gt;</span></div><div>&lt;bean id=&quot;myDataSource&quot; class=&quot;com.alibaba.druid.pool.DruidDataSource&quot; init-method=&quot;init&quot; destory-method=&quot;close&quot;&gt;</div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">&lt;set注入给DruidDataSource提供连接数据库的信息&gt;</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">&lt;property name=&quot;url&quot; value=&quot;&quot;&gt;</span></div><div>&lt;property name=&quot;username&quot; value=&quot;&quot;&gt;</div><div>&lt;property name=&quot;password&quot; value=&quot;&quot;&gt;</div><div>&lt;property name=&quot;maxActive&quot; value=&quot;&quot;&gt;</div><div>&lt;/bean&gt;</div></div><div>2&gt;SqlSessionFactoryBean(org.mybatis.spring)</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">&lt;bean id=&quot;s</span>qlSessionFactory<span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">&quot; class=&quot;</span>SqlSessionFactoryBean<span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">&quot;&gt;</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">&lt;!--set注入，把数据库连接池付给了dataSource属性--&gt;</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">&lt;property name=&quot;dataSource&quot; ref=&quot;</span>myDataSource<span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">&quot;&gt;</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">&lt;!--mybatis主配置文件的位置,value写的是主配置文件路径--&gt;</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">&lt;!--configLocation属性是Resource类型，是spring中的接口，用来读取配置文件的，它的赋值，使用value，指定文件的路径：classpath：表示文件的位置--&gt;</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">&lt;property name=&quot;configLocation&quot; value=&quot;classpath:文件路径&quot;&gt;</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">&lt;/bean&gt;</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;"><br/></span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;"><br/></span></div></div><div>3&gt;创建dao类</div><div>&lt;</div><div>        创建dao对象，使用SqlSession的getMapper（dao.class）</div><div>    MapperScannerConfigurer:在内部调用getMapper()生成每个        dao接口的代理对象</div><div>&gt;</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">&lt;bean class=&quot;org.mybatis.spring.mapper.mapperScannerConfigurer&quot;&gt;</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">&lt;!--指定SqlSessionFactory对象的id--&gt;</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">&lt;property name=&quot;sqlSessionFactoryBeanName&quot; value=&quot;</span>sqlSessionFactory<span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">&quot;&gt;</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">&lt;指定包名，dao接口所在的包名,</span>MapperScannerConfigurer会扫描这个包中的所有接口， 把每个接口都执行一次getMapper()方法，得到每个接口的dao对象。创建好的dao对象是放到spring的容器中的。<span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">&gt;</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">&lt;property name=&quot;basePackage&quot; value=&quot;包名&quot;&gt;</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">&lt;/bean&gt;</span></div><div><br/></div><div><br/></div></div><div><span style="font-size: unset; color: unset; font-family: unset;">spring和mybatis整合之后，事务是自动提交的。无需执行SqlSession.commit();</span></div><div><br/></div><div>使用属性配置文件</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">&lt;context:property-placeholder location=&quot;classpath:文件路径&quot;&gt;</span></div><div>&lt;bean id=&quot;myDataSource&quot; class=&quot;com.alibaba.druid.pool.DruidDataSource&quot; init-method=&quot;init&quot; destory-method=&quot;close&quot;&gt;</div><div>&lt;set注入给DruidDataSource提供连接数据库的信息&gt;</div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">&lt;!--使用属性配置文件中的数据，语法${key}--&gt;</span></div><div>&lt;property name=&quot;url&quot; value=&quot;${}&quot;&gt;</div><div>&lt;property name=&quot;username&quot; value=&quot;${}&quot;&gt;</div><div>&lt;property name=&quot;password&quot; value=&quot;${}&quot;&gt;</div><div>&lt;property name=&quot;maxActive&quot; value=&quot;${}&quot;&gt;</div><div>&lt;/bean&gt;</div></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></span>
</div></body></html> 