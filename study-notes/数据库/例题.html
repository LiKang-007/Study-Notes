<html>
<head>
  <title>例题</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/602916 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1971"/>
<h1>例题</h1>

<div>
<span><div>例题</div><div>13.有3个表S(学生表)，C（课程表），SC（学生选课表）</div><div>S（SNO，SNAME）代表（学号，姓名）</div><div>C（CNO，CNAME，CTEACHER）代表（课号，课名，教师）</div><div>SC（SNO，CNO，SCGRADE）代表（学号，课号，成绩）</div><div>问题：</div><div>1、找出没选过“黎明”老师的所有学生姓名。</div><div>select s.sname from s join (select distinct sc.sno from sc join ( select cno from c where cteacher='黎明' ) t on t.cno=sc.cno ) n on n.sno=s.sno;</div><div><br/></div><div>2、列出2门以上（含2门）不及格学生姓名及平均成绩。</div><div>select s.sname from s right join (select sno,a from (select sno,count(cno) a from sc where scgrade&lt;60 group by sno ) A where a&gt;=2) first on first.sno=s.sno ;</div><div>+----------+</div><div>| sname    |</div><div>+----------+</div><div>| zhangsan |</div><div>+----------+</div><div>3、即学过1号课程又学过2号课所有学生的姓名。</div><div>select  sno from sc where cno=1 and cno=2；</div><div><br/></div><div>create table s(</div><div>    sno int(4) primary key auto_increment,</div><div>    sname varchar(32)</div><div>);</div><div><br/></div><div>insert into s(sname) values('zhangsan');</div><div>insert into s(sname) values('lisi');</div><div>insert into s(sname) values('wangwu');</div><div>insert into s(sname) values('zhaoliu');</div><div><br/></div><div>create table c(</div><div>    cno int(4) primary key auto_increment,</div><div>    cname varchar(32),</div><div>    cteacher varchar(32)</div><div>);</div><div>insert into c(cname,cteacher) values('Java','吴老师');</div><div>insert into c(cname,cteacher) values('C++','王老师');</div><div>insert into c(cname,cteacher) values('C##','张老师');</div><div>insert into c(cname,cteacher) values('MySQL','郭老师');</div><div>insert into c(cname,cteacher) values('Oracle','黎明');</div><div><br/></div><div><br/></div><div>create table sc(</div><div>    sno int(4),</div><div>    cno int(4),</div><div>    scgrade double(3,1),</div><div>    constraint sc_sno_cno_pk primary key(sno,cno),</div><div>    constraint sc_sno_fk foreign key(sno) references s(sno),</div><div>    constraint sc_cno_fk foreign key(cno) references c(cno)</div><div>);</div><div><br/></div><div>insert into sc(sno,cno,scgrade) values(1,1,30);</div><div>insert into sc(sno,cno,scgrade) values(1,2,50);</div><div>insert into sc(sno,cno,scgrade) values(1,3,80);</div><div>insert into sc(sno,cno,scgrade) values(1,4,90);</div><div>insert into sc(sno,cno,scgrade) values(1,5,70);</div><div>insert into sc(sno,cno,scgrade) values(2,2,80);</div><div>insert into sc(sno,cno,scgrade) values(2,3,50);</div><div>insert into sc(sno,cno,scgrade) values(2,4,70);</div><div>insert into sc(sno,cno,scgrade) values(2,5,80);</div><div>insert into sc(sno,cno,scgrade) values(3,1,60);</div><div>insert into sc(sno,cno,scgrade) values(3,2,70);</div><div>insert into sc(sno,cno,scgrade) values(3,3,80);</div><div>insert into sc(sno,cno,scgrade) values(4,3,50);</div><div>insert into sc(sno,cno,scgrade) values(4,4,80);</div><div><br/></div><div><br/></div><div>/*</div><div>1、找出没选过“黎明”老师的所有学生姓名。</div><div>2、列出2门以上（含2门）不及格学生姓名及平均成绩。</div><div>3、即学过1号课程又学过2号课所有学生的姓名。                          </div><div>*/</div><div><br/></div><div>--先找出选过黎明老师的学生编号 -&gt; 黎明老师的授课的编号</div><div>select cno from c where cteacher = '黎明';</div><div><br/></div><div>select sno from sc where cno = (select cno from c where cteacher = '黎明');</div><div><br/></div><div>select * from s where sno not in(select sno from sc where cno = (select cno from c where cteacher = '黎明'));</div><div><br/></div><div>--列出2门以上（含2门）不及格学生姓名及平均成绩</div><div>t1</div><div>select</div><div>       sc.sno,s.sname,count(*) as studentNum</div><div>from</div><div>     sc</div><div>join</div><div>    s</div><div>on</div><div>     sc.sno = s.sno</div><div>where</div><div>      scgrade &lt; 60</div><div>group by</div><div>      sc.sno,s.sname</div><div>having</div><div>      studentNum &gt;= 2;</div><div><br/></div><div>t2</div><div>select</div><div>       sc.sno,avg(sc.scgrade) as avgscgrade</div><div>from</div><div>       sc</div><div>group by</div><div>      sc.sno;</div><div>      </div><div><br/></div><div>select</div><div>       t1.sname,t2.avgscgrade</div><div>from</div><div>       (select</div><div>               sc.sno,s.sname,count(*) as studentNum</div><div>        from</div><div>             sc</div><div>        join</div><div>            s</div><div>        on</div><div>             sc.sno = s.sno</div><div>        where</div><div>              scgrade &lt; 60</div><div>        group by</div><div>              sc.sno,s.sname</div><div>        having</div><div>              studentNum &gt;= 2) t1</div><div>join</div><div>       (select</div><div>               sc.sno,avg(sc.scgrade) as avgscgrade</div><div>        from</div><div>               sc</div><div>        group by</div><div>              sc.sno) t2</div><div>on</div><div>       t1.sno = t2.sno;</div><div><br/></div><div>--即学过1号课程又学过2号课所有学生的姓名</div><div>select sno from sc where cno = 1;</div><div>select sno from sc where cno = 2;</div><div><br/></div><div>select</div><div>       s.sname</div><div>from</div><div>       sc</div><div>join</div><div>       s</div><div>on</div><div>       sc.sno = s.sno</div><div>where</div><div>      cno = 1 and sc.sno in(select sno from sc where cno = 2);</div><div><br/></div><div><br/></div><div>1.取得每个部门最高薪水的人员名称</div><div>第一步：求出每个部门的最高薪水</div><div>select</div><div>    e.deptno,max(e.sal) as maxsal</div><div>from</div><div>    emp e</div><div>group by</div><div>    e.deptno;</div><div>+--------+---------+</div><div>| deptno | maxsal  |</div><div>+--------+---------+</div><div>|     10 | 5000.00 |</div><div>|     20 | 3000.00 |</div><div>|     30 | 2850.00 |</div><div>+--------+---------+</div><div>将以上查询结果当成一个临时表t(deptno,maxsal)</div><div>select</div><div>    e.deptno,e.ename,t.maxsal,e.sal</div><div>from</div><div>    (select</div><div>            e.deptno,max(e.sal) as maxsal</div><div>        from</div><div>            emp e</div><div>        group by</div><div>            e.deptno)t</div><div>join</div><div>    emp e</div><div>on</div><div>    t.deptno = e.deptno</div><div>where</div><div>    t.maxsal = e.sal</div><div>order by</div><div>    e.deptno;</div><div>+--------+-------+---------+---------+</div><div>| deptno | ename | maxsal  | sal     |</div><div>+--------+-------+---------+---------+</div><div>|     10 | KING  | 5000.00 | 5000.00 |</div><div>|     20 | SCOTT | 3000.00 | 3000.00 |</div><div>|     20 | FORD  | 3000.00 | 3000.00 |</div><div>|     30 | BLAKE | 2850.00 | 2850.00 |</div><div>+--------+-------+---------+---------+</div><div><br/></div><div>2.哪些人的薪水在部门平均薪水之上</div><div>第一步：求出每个部门的平均薪水</div><div>select</div><div>    e.deptno,avg(e.sal) as avgsal</div><div>from</div><div>    emp e</div><div>group by</div><div>    e.deptno;</div><div>+--------+-------------+</div><div>| deptno | avgsal      |</div><div>+--------+-------------+</div><div>|     10 | 2916.666667 |</div><div>|     20 | 2175.000000 |</div><div>|     30 | 1566.666667 |</div><div>+--------+-------------+</div><div>将以上查询结果当成临时表t(deptno,avgsal)</div><div><br/></div><div>select</div><div>    t.deptno,e.ename</div><div>from</div><div>    (select</div><div>        e.deptno,avg(e.sal) as avgsal</div><div>    from</div><div>        emp e</div><div>    group by</div><div>        e.deptno) t</div><div>join</div><div>    emp e</div><div>on</div><div>    e.deptno = t.deptno</div><div>where</div><div>    e.sal &gt; t.avgsal;</div><div>+--------+-------+</div><div>| deptno | ename |</div><div>+--------+-------+</div><div>|     30 | ALLEN |</div><div>|     20 | JONES |</div><div>|     30 | BLAKE |</div><div>|     20 | SCOTT |</div><div>|     10 | KING  |</div><div>|     20 | FORD  |</div><div>+--------+-------+</div><div><br/></div><div>3.取得部门中（所有人的）平均薪水等级</div><div>3.1 取得部门中所有人的平均薪水的等级</div><div>第一步：求出部门的平均薪水</div><div>select</div><div>    e.deptno,avg(e.sal) as avgsal</div><div>from</div><div>    emp e</div><div>group by</div><div>    e.deptno;</div><div>将以下查询结果当成临时表t(deptno,avgsal)</div><div>+--------+-------------+</div><div>| deptno | avgsal      |</div><div>+--------+-------------+</div><div>|     10 | 2916.666667 |</div><div>|     20 | 2175.000000 |</div><div>|     30 | 1566.666667 |</div><div>+--------+-------------+</div><div><br/></div><div>select * from salgrade;</div><div>+-------+-------+-------+</div><div>| GRADE | LOSAL | HISAL |</div><div>+-------+-------+-------+</div><div>|     1 |   700 |  1200 |</div><div>|     2 |  1201 |  1400 |</div><div>|     3 |  1401 |  2000 |</div><div>|     4 |  2001 |  3000 |</div><div>|     5 |  3001 |  9999 |</div><div>+-------+-------+-------+</div><div><br/></div><div>select</div><div>    t.deptno,t.avgsal,s.grade</div><div>from</div><div>    (select</div><div>            e.deptno,avg(e.sal) as avgsal</div><div>        from</div><div>            emp e</div><div>        group by</div><div>            e.deptno) t</div><div>join</div><div>    salgrade s</div><div>on</div><div>    t.avgsal between s.losal and s.hisal;</div><div>+--------+-------------+-------+</div><div>| deptno | avgsal      | grade |</div><div>+--------+-------------+-------+</div><div>|     30 | 1566.666667 |     3 |</div><div>|     10 | 2916.666667 |     4 |</div><div>|     20 | 2175.000000 |     4 |</div><div>+--------+-------------+-------+</div><div><br/></div><div><br/></div><div>3.2 取得部门中所有人的平均的薪水等级</div><div>第一步：求出每个人的薪水等级</div><div>select</div><div>    e.deptno,e.ename,s.grade</div><div>from</div><div>    emp e</div><div>join</div><div>    salgrade s</div><div>on</div><div>    e.sal between s.losal and s.hisal</div><div>order by</div><div>    e.deptno;</div><div>+--------+--------+-------+</div><div>| deptno | ename  | grade |</div><div>+--------+--------+-------+</div><div>|     10 | CLARK  |     4 |</div><div>|     10 | MILLER |     2 |</div><div>|     10 | KING   |     5 |</div><div>|     20 | ADAMS  |     1 |</div><div>|     20 | SMITH  |     1 |</div><div>|     20 | FORD   |     4 |</div><div>|     20 | SCOTT  |     4 |</div><div>|     20 | JONES  |     4 |</div><div>|     30 | BLAKE  |     4 |</div><div>|     30 | JAMES  |     1 |</div><div>|     30 | ALLEN  |     3 |</div><div>|     30 | WARD   |     2 |</div><div>|     30 | TURNER |     3 |</div><div>|     30 | MARTIN |     2 |</div><div>+--------+--------+-------+</div><div>将以上查询结果当成临时表t(deptno,ename,grade)</div><div>select</div><div>    t.deptno,avg(t.grade) as avgGrade</div><div>from</div><div>    (select</div><div>        e.deptno,e.ename,s.grade</div><div>    from</div><div>        emp e</div><div>    join</div><div>        salgrade s</div><div>    on</div><div>        e.sal between s.losal and s.hisal) t</div><div>group by</div><div>    t.deptno;</div><div>+--------+----------+</div><div>| deptno | avgGrade |</div><div>+--------+----------+</div><div>|     10 |   3.6667 |</div><div>|     20 |   2.8000 |</div><div>|     30 |   2.5000 |</div><div>+--------+----------+</div><div><br/></div><div>4.不准用组函数（MAX），取得最高薪水（给出两种解决方案）</div><div>select sal from emp order by sal desc limit 1;</div><div>+---------+</div><div>| sal     |</div><div>+---------+</div><div>| 5000.00 |</div><div>+---------+</div><div><br/></div><div>a</div><div>+---------+</div><div>| sal     |</div><div>+---------+</div><div>|  800.00 |</div><div>| 1600.00 |</div><div>| 1250.00 |</div><div>| 2975.00 |</div><div>| 1250.00 |</div><div>| 2850.00 |</div><div>| 2450.00 |</div><div>| 3000.00 |</div><div>| 5000.00 |</div><div>| 1500.00 |</div><div>| 1100.00 |</div><div>|  950.00 |</div><div>| 3000.00 |</div><div>| 1300.00 |</div><div>+---------+</div><div><br/></div><div>b</div><div>+---------+</div><div>| sal     |</div><div>+---------+</div><div>|  800.00 |</div><div>| 1600.00 |</div><div>| 1250.00 |</div><div>| 2975.00 |</div><div>| 1250.00 |</div><div>| 2850.00 |</div><div>| 2450.00 |</div><div>| 3000.00 |</div><div>| 5000.00 |</div><div>| 1500.00 |</div><div>| 1100.00 |</div><div>|  950.00 |</div><div>| 3000.00 |</div><div>| 1300.00 |</div><div>+---------+</div><div><br/></div><div>select</div><div>    distinct a.sal</div><div>from</div><div>    emp a</div><div>join</div><div>    emp b</div><div>on</div><div>    a.sal &lt; b.sal;</div><div><br/></div><div>select sal from emp where sal not in(select</div><div>                    distinct a.sal</div><div>                from</div><div>                    emp a</div><div>                join</div><div>                    emp b</div><div>                on</div><div>                    a.sal &lt; b.sal);</div><div>select sal from emp where sal not in(select</div><div>                    distinct a.sal</div><div>                from</div><div>                    emp a</div><div>                join</div><div>                    emp b</div><div>                on</div><div>                    a.sal &gt; b.sal);</div><div><br/></div><div>5.取得平均薪水最高的部门的部门编号</div><div>第一步：求出部门平均薪水</div><div>select</div><div>    e.deptno,avg(e.sal) as avgsal</div><div>from</div><div>    emp e</div><div>group by</div><div>    e.deptno;</div><div>+--------+-------------+</div><div>| deptno | avgsal      |</div><div>+--------+-------------+</div><div>|     10 | 2916.666667 |</div><div>|     20 | 2175.000000 |</div><div>|     30 | 1566.666667 |</div><div>+--------+-------------+</div><div>第二步：将以上查询结果当成临时表t(deptno,avgsal)</div><div>select max(t.avgsal) as maxAvgSal from (select</div><div>                        e.deptno,avg(e.sal) as avgsal</div><div>                    from</div><div>                        emp e</div><div>                    group by</div><div>                        e.deptno) t;</div><div>+-------------+</div><div>| maxAvgSal   |</div><div>+-------------+</div><div>| 2916.666667 |</div><div>+-------------+</div><div><br/></div><div>select</div><div>    e.deptno,avg(e.sal) as avgsal</div><div>from</div><div>    emp e</div><div>group by</div><div>    e.deptno</div><div>having</div><div>    avgsal = (select max(t.avgsal) as maxAvgSal from (select</div><div>                        e.deptno,avg(e.sal) as avgsal</div><div>                    from</div><div>                        emp e</div><div>                    group by</div><div>                        e.deptno) t);</div><div>+--------+-------------+</div><div>| deptno | avgsal      |</div><div>+--------+-------------+</div><div>|     10 | 2916.666667 |</div><div>+--------+-------------+</div><div><br/></div><div>6.取得平均薪水最高的部门的部门名称</div><div>select</div><div>    e.deptno,d.dname,avg(e.sal) as avgsal</div><div>from</div><div>    emp e</div><div>join</div><div>    dept d</div><div>on</div><div>    e.deptno = d.deptno</div><div>group by</div><div>    e.deptno,d.dname</div><div>having</div><div>    avgsal = (select max(t.avgsal) as maxAvgSal from (select</div><div>                        e.deptno,avg(e.sal) as avgsal</div><div>                    from</div><div>                        emp e</div><div>                    group by</div><div>                        e.deptno) t);</div><div><br/></div><div>7.求平均薪水的等级最低的部门的部门名称</div><div>第一步：部门的平均薪水</div><div>select</div><div>    e.deptno,d.dname,avg(e.sal) as avgsal</div><div>from</div><div>    emp e</div><div>join</div><div>    dept d</div><div>on</div><div>    e.deptno = d.deptno</div><div>group by</div><div>    e.deptno,d.dname;</div><div>+--------+------------+-------------+</div><div>| deptno | dname      | avgsal      |</div><div>+--------+------------+-------------+</div><div>|     10 | ACCOUNTING | 2916.666667 |</div><div>|     20 | RESEARCH   | 2175.000000 |</div><div>|     30 | SALES      | 1566.666667 |</div><div>+--------+------------+-------------+</div><div>第二步：将以上结果当成临时表t(deptno,avgsal)与salgrade表进行表连接：t.avgsal between s.losal and s.hisal;</div><div>select</div><div>    t.deptno,t.dname,s.grade</div><div>from    </div><div>    (select</div><div>            e.deptno,d.dname,avg(e.sal) as avgsal</div><div>        from</div><div>            emp e</div><div>        join</div><div>            dept d</div><div>        on</div><div>            e.deptno = d.deptno</div><div>        group by</div><div>            e.deptno,d.dname)t</div><div>join</div><div>    salgrade s</div><div>on</div><div>    t.avgsal between s.losal and s.hisal;</div><div>+--------+------------+-------+</div><div>| deptno | dname      | grade |</div><div>+--------+------------+-------+</div><div>|     30 | SALES      |     3 |</div><div>|     10 | ACCOUNTING |     4 |</div><div>|     20 | RESEARCH   |     4 |</div><div>+--------+------------+-------+</div><div><br/></div><div>第三步：将以上查询结果当成一张临时表t</div><div>select min(t.grade) as minGrade from (select</div><div>                    t.deptno,t.dname,s.grade</div><div>                from    </div><div>                    (select</div><div>                            e.deptno,d.dname,avg(e.sal) as avgsal</div><div>                        from</div><div>                            emp e</div><div>                        join</div><div>                            dept d</div><div>                        on</div><div>                            e.deptno = d.deptno</div><div>                        group by</div><div>                            e.deptno,d.dname)t</div><div>                join</div><div>                    salgrade s</div><div>                on</div><div>                    t.avgsal between s.losal and s.hisal)t;</div><div>+----------+</div><div>| minGrade |</div><div>+----------+</div><div>|        3 |</div><div>+----------+</div><div><br/></div><div>select</div><div>    t.deptno,t.dname,s.grade</div><div>from    </div><div>    (select</div><div>            e.deptno,d.dname,avg(e.sal) as avgsal</div><div>        from</div><div>            emp e</div><div>        join</div><div>            dept d</div><div>        on</div><div>            e.deptno = d.deptno</div><div>        group by</div><div>            e.deptno,d.dname)t</div><div>join</div><div>    salgrade s</div><div>on</div><div>    t.avgsal between s.losal and s.hisal</div><div>where</div><div>    s.grade = (select min(t.grade) as minGrade from (select</div><div>                    t.deptno,t.dname,s.grade</div><div>                from    </div><div>                    (select</div><div>                            e.deptno,d.dname,avg(e.sal) as avgsal</div><div>                        from</div><div>                            emp e</div><div>                        join</div><div>                            dept d</div><div>                        on</div><div>                            e.deptno = d.deptno</div><div>                        group by</div><div>                            e.deptno,d.dname)t</div><div>                join</div><div>                    salgrade s</div><div>                on</div><div>                    t.avgsal between s.losal and s.hisal)t);</div><div>+--------+-------+-------+</div><div>| deptno | dname | grade |</div><div>+--------+-------+-------+</div><div>|     30 | SALES |     3 |</div><div>+--------+-------+-------+</div><div><br/></div><div>8.取得比普通员工（员工代码没有在mgr上出现的）的最高薪水还要高的经理人姓名</div><div>第一步：找出普通员工(员工代码没有出现在mgr上的)</div><div>    1.1 先找出mgr有哪些人</div><div>    select distinct mgr from emp;</div><div>        +------+</div><div>        | mgr  |</div><div>        +------+</div><div>        | 7902 |</div><div>        | 7698 |</div><div>        | 7839 |</div><div>        | 7566 |</div><div>        | NULL |</div><div>        | 7788 |</div><div>        | 7782 |</div><div>        +------+</div><div>select * from emp where empno in(select distinct mgr from emp);</div><div>+-------+-------+-----------+------+------------+---------+------+--------+</div><div>| EMPNO | ENAME | JOB       | MGR  | HIREDATE   | SAL     | COMM | DEPTNO |</div><div>+-------+-------+-----------+------+------------+---------+------+--------+</div><div>|  7566 | JONES | MANAGER   | 7839 | 1981-04-02 | 2975.00 | NULL |     20 |</div><div>|  7698 | BLAKE | MANAGER   | 7839 | 1981-05-01 | 2850.00 | NULL |     30 |</div><div>|  7782 | CLARK | MANAGER   | 7839 | 1981-06-09 | 2450.00 | NULL |     10 |</div><div>|  7788 | SCOTT | ANALYST   | 7566 | 1987-04-19 | 3000.00 | NULL |     20 |</div><div>|  7839 | KING  | PRESIDENT | NULL | 1981-11-17 | 5000.00 | NULL |     10 |</div><div>|  7902 | FORD  | ANALYST   | 7566 | 1981-12-03 | 3000.00 | NULL |     20 |</div><div>+-------+-------+-----------+------+------------+---------+------+--------+</div><div>select max(sal) as maxsal from emp where empno not in(select distinct mgr from emp where mgr is not null);</div><div>+---------+</div><div>| maxsal  |</div><div>+---------+</div><div>| 1600.00 |</div><div>+---------+</div><div><br/></div><div>not in不会自动忽略空值</div><div>in会自动忽略空值</div><div><br/></div><div><br/></div><div>select ename from emp where sal &gt; (select max(sal) as maxsal from emp where empno not in(select distinct mgr from emp where mgr is not null));</div><div>+-------+</div><div>| ename |</div><div>+-------+</div><div>| JONES |</div><div>| BLAKE |</div><div>| CLARK |</div><div>| SCOTT |</div><div>| KING  |</div><div>| FORD  |</div><div>+-------+</div><div><br/></div><div>9.取得薪水最高的前五名员工</div><div>select * from emp order by sal desc limit 0,5;</div><div>+-------+-------+-----------+------+------------+---------+------+--------+</div><div>| EMPNO | ENAME | JOB       | MGR  | HIREDATE   | SAL     | COMM | DEPTNO |</div><div>+-------+-------+-----------+------+------------+---------+------+--------+</div><div>|  7839 | KING  | PRESIDENT | NULL | 1981-11-17 | 5000.00 | NULL |     10 |</div><div>|  7788 | SCOTT | ANALYST   | 7566 | 1987-04-19 | 3000.00 | NULL |     20 |</div><div>|  7902 | FORD  | ANALYST   | 7566 | 1981-12-03 | 3000.00 | NULL |     20 |</div><div>|  7566 | JONES | MANAGER   | 7839 | 1981-04-02 | 2975.00 | NULL |     20 |</div><div>|  7698 | BLAKE | MANAGER   | 7839 | 1981-05-01 | 2850.00 | NULL |     30 |</div><div>+-------+-------+-----------+------+------------+---------+------+--------+</div><div><br/></div><div>10.取得薪水最高的第六到第十名员工</div><div><br/></div><div>select * from emp order by sal desc limit 5,5;</div><div>+-------+--------+----------+------+------------+---------+---------+--------+</div><div>| EMPNO | ENAME  | JOB      | MGR  | HIREDATE   | SAL     | COMM    | DEPTNO |</div><div>+-------+--------+----------+------+------------+---------+---------+--------+</div><div>|  7782 | CLARK  | MANAGER  | 7839 | 1981-06-09 | 2450.00 |    NULL |     10 |</div><div>|  7499 | ALLEN  | SALESMAN | 7698 | 1981-02-20 | 1600.00 |  300.00 |     30 |</div><div>|  7844 | TURNER | SALESMAN | 7698 | 1981-09-08 | 1500.00 |    0.00 |     30 |</div><div>|  7934 | MILLER | CLERK    | 7782 | 1982-01-23 | 1300.00 |    NULL |     10 |</div><div>|  7654 | MARTIN | SALESMAN | 7698 | 1981-09-28 | 1250.00 | 1400.00 |     30 |</div><div>+-------+--------+----------+------+------------+---------+---------+--------+</div><div><br/></div><div>11.取得最后入职的5名员工</div><div>select * from emp order by hiredate desc limit 5;</div><div>+-------+--------+---------+------+------------+---------+------+--------+</div><div>| EMPNO | ENAME  | JOB     | MGR  | HIREDATE   | SAL     | COMM | DEPTNO |</div><div>+-------+--------+---------+------+------------+---------+------+--------+</div><div>|  7876 | ADAMS  | CLERK   | 7788 | 1987-05-23 | 1100.00 | NULL |     20 |</div><div>|  7788 | SCOTT  | ANALYST | 7566 | 1987-04-19 | 3000.00 | NULL |     20 |</div><div>|  7934 | MILLER | CLERK   | 7782 | 1982-01-23 | 1300.00 | NULL |     10 |</div><div>|  7902 | FORD   | ANALYST | 7566 | 1981-12-03 | 3000.00 | NULL |     20 |</div><div>|  7900 | JAMES  | CLERK   | 7698 | 1981-12-03 |  950.00 | NULL |     30 |</div><div>+-------+--------+---------+------+------------+---------+------+--------+</div><div><br/></div><div>12.取得每个薪水等级有多少员工</div><div>第一步：查询出每个员工的薪水等级</div><div>select</div><div>    e.ename,s.grade</div><div>from</div><div>    emp e</div><div>join</div><div>    salgrade s</div><div>on</div><div>    e.sal between s.losal and s.hisal</div><div>order by</div><div>    s.grade;</div><div>+--------+-------+</div><div>| ename  | grade |</div><div>+--------+-------+</div><div>| JAMES  |     1 |</div><div>| SMITH  |     1 |</div><div>| ADAMS  |     1 |</div><div>| MILLER |     2 |</div><div>| WARD   |     2 |</div><div>| MARTIN |     2 |</div><div>| ALLEN  |     3 |</div><div>| TURNER |     3 |</div><div>| BLAKE  |     4 |</div><div>| FORD   |     4 |</div><div>| CLARK  |     4 |</div><div>| SCOTT  |     4 |</div><div>| JONES  |     4 |</div><div>| KING   |     5 |</div><div>+--------+-------+</div><div><br/></div><div>将以上查询结果当成临时表t(ename,grade)</div><div>select</div><div>    t.grade,count(t.ename) as totalEmp</div><div>from</div><div>    (select</div><div>        e.ename,s.grade</div><div>    from</div><div>        emp e</div><div>    join</div><div>        salgrade s</div><div>    on</div><div>        e.sal between s.losal and s.hisal) t</div><div>group by</div><div>    t.grade;</div><div>+-------+----------+</div><div>| grade | totalEmp |</div><div>+-------+----------+</div><div>|     1 |        3 |</div><div>|     2 |        3 |</div><div>|     3 |        2 |</div><div>|     4 |        5 |</div><div>|     5 |        1 |</div><div>+-------+----------+</div><div><br/></div><div>14.列出所有员工及领导的名字</div><div>select</div><div>    e.ename,</div><div>    b.ename as leadername</div><div>from</div><div>    emp e</div><div>left join</div><div>    emp b</div><div>on</div><div>    e.mgr = b.empno;</div><div>+--------+------------+</div><div>| ename  | leadername |</div><div>+--------+------------+</div><div>| SMITH  | FORD       |</div><div>| ALLEN  | BLAKE      |</div><div>| WARD   | BLAKE      |</div><div>| JONES  | KING       |</div><div>| MARTIN | BLAKE      |</div><div>| BLAKE  | KING       |</div><div>| CLARK  | KING       |</div><div>| SCOTT  | JONES      |</div><div>| KING   | NULL       |</div><div>| TURNER | BLAKE      |</div><div>| ADAMS  | SCOTT      |</div><div>| JAMES  | BLAKE      |</div><div>| FORD   | JONES      |</div><div>| MILLER | CLARK      |</div><div>+--------+------------+</div><div><br/></div><div>15.列出受雇日期早于其直接上级的所有员工编号、姓名、部门名称</div><div>select</div><div>    d.dname,</div><div>    e.empno,</div><div>    e.ename</div><div>from</div><div>    emp e</div><div>join</div><div>    emp b</div><div>on</div><div>    e.mgr = b.empno</div><div>join</div><div>    dept d</div><div>on</div><div>    e.deptno = d.deptno</div><div>where</div><div>    e.hiredate &lt; b.hiredate;</div><div>+------------+-------+-------+</div><div>| dname      | empno | ename |</div><div>+------------+-------+-------+</div><div>| ACCOUNTING |  7782 | CLARK |</div><div>| RESEARCH   |  7369 | SMITH |</div><div>| RESEARCH   |  7566 | JONES |</div><div>| SALES      |  7499 | ALLEN |</div><div>| SALES      |  7521 | WARD  |</div><div>| SALES      |  7698 | BLAKE |</div><div>+------------+-------+-------+</div><div><br/></div><div>16.列出部门名称和这些部门的员工信息，同时列出那些没有员工的部门</div><div>select</div><div>    d.dname,</div><div>    e.*</div><div>from</div><div>    emp e</div><div>right join</div><div>    dept d</div><div>on</div><div>    e.deptno = d.deptno;</div><div>+------------+-------+--------+-----------+------+------------+---------+---------+--------+</div><div>| dname      | EMPNO | ENAME  | JOB       | MGR  | HIREDATE   | SAL     | COMM    | DEPTNO |</div><div>+------------+-------+--------+-----------+------+------------+---------+---------+--------+</div><div>| ACCOUNTING |  7782 | CLARK  | MANAGER   | 7839 | 1981-06-09 | 2450.00 |    NULL |     10 |</div><div>| ACCOUNTING |  7839 | KING   | PRESIDENT | NULL | 1981-11-17 | 5000.00 |    NULL |     10 |</div><div>| ACCOUNTING |  7934 | MILLER | CLERK     | 7782 | 1982-01-23 | 1300.00 |    NULL |     10 |</div><div>| RESEARCH   |  7369 | SMITH  | CLERK     | 7902 | 1980-12-17 |  800.00 |    NULL |     20 |</div><div>| RESEARCH   |  7566 | JONES  | MANAGER   | 7839 | 1981-04-02 | 2975.00 |    NULL |     20 |</div><div>| RESEARCH   |  7788 | SCOTT  | ANALYST   | 7566 | 1987-04-19 | 3000.00 |    NULL |     20 |</div><div>| RESEARCH   |  7876 | ADAMS  | CLERK     | 7788 | 1987-05-23 | 1100.00 |    NULL |     20 |</div><div>| RESEARCH   |  7902 | FORD   | ANALYST   | 7566 | 1981-12-03 | 3000.00 |    NULL |     20 |</div><div>| SALES      |  7499 | ALLEN  | SALESMAN  | 7698 | 1981-02-20 | 1600.00 |  300.00 |     30 |</div><div>| SALES      |  7521 | WARD   | SALESMAN  | 7698 | 1981-02-22 | 1250.00 |  500.00 |     30 |</div><div>| SALES      |  7654 | MARTIN | SALESMAN  | 7698 | 1981-09-28 | 1250.00 | 1400.00 |     30 |</div><div>| SALES      |  7698 | BLAKE  | MANAGER   | 7839 | 1981-05-01 | 2850.00 |    NULL |     30 |</div><div>| SALES      |  7844 | TURNER | SALESMAN  | 7698 | 1981-09-08 | 1500.00 |    0.00 |     30 |</div><div>| SALES      |  7900 | JAMES  | CLERK     | 7698 | 1981-12-03 |  950.00 |    NULL |     30 |</div><div>| OPERATIONS |  NULL | NULL   | NULL      | NULL | NULL       |    NULL |    NULL |   NULL |</div><div>+------------+-------+--------+-----------+------+------------+---------+---------+--------+</div><div><br/></div><div>17.列出至少有5个员工的所有部门</div><div>第一步：先求出每个部门的员工数量</div><div>select</div><div>    e.deptno,count(e.ename) as totalEmp</div><div>from</div><div>    emp e</div><div>group by</div><div>    e.deptno;</div><div>+--------+----------+</div><div>| deptno | totalEmp |</div><div>+--------+----------+</div><div>|     10 |        3 |</div><div>|     20 |        5 |</div><div>|     30 |        6 |</div><div>+--------+----------+</div><div><br/></div><div>select</div><div>    e.deptno,count(e.ename) as totalEmp</div><div>from</div><div>    emp e</div><div>group by</div><div>    e.deptno</div><div>having</div><div>    totalEmp &gt;= 5;</div><div>+--------+----------+</div><div>| deptno | totalEmp |</div><div>+--------+----------+</div><div>|     20 |        5 |</div><div>|     30 |        6 |</div><div>+--------+----------+</div><div><br/></div><div>18.列出薪水比“SMITH”多的所有员工信息</div><div>select sal from emp where ename = 'SMITH';</div><div>+--------+</div><div>| sal    |</div><div>+--------+</div><div>| 800.00 |</div><div>+--------+</div><div>select * from emp where sal &gt; (select sal from emp where ename = 'SMITH');</div><div>+-------+--------+-----------+------+------------+---------+---------+--------+</div><div>| EMPNO | ENAME  | JOB       | MGR  | HIREDATE   | SAL     | COMM    | DEPTNO |</div><div>+-------+--------+-----------+------+------------+---------+---------+--------+</div><div>|  7499 | ALLEN  | SALESMAN  | 7698 | 1981-02-20 | 1600.00 |  300.00 |     30 |</div><div>|  7521 | WARD   | SALESMAN  | 7698 | 1981-02-22 | 1250.00 |  500.00 |     30 |</div><div>|  7566 | JONES  | MANAGER   | 7839 | 1981-04-02 | 2975.00 |    NULL |     20 |</div><div>|  7654 | MARTIN | SALESMAN  | 7698 | 1981-09-28 | 1250.00 | 1400.00 |     30 |</div><div>|  7698 | BLAKE  | MANAGER   | 7839 | 1981-05-01 | 2850.00 |    NULL |     30 |</div><div>|  7782 | CLARK  | MANAGER   | 7839 | 1981-06-09 | 2450.00 |    NULL |     10 |</div><div>|  7788 | SCOTT  | ANALYST   | 7566 | 1987-04-19 | 3000.00 |    NULL |     20 |</div><div>|  7839 | KING   | PRESIDENT | NULL | 1981-11-17 | 5000.00 |    NULL |     10 |</div><div>|  7844 | TURNER | SALESMAN  | 7698 | 1981-09-08 | 1500.00 |    0.00 |     30 |</div><div>|  7876 | ADAMS  | CLERK     | 7788 | 1987-05-23 | 1100.00 |    NULL |     20 |</div><div>|  7900 | JAMES  | CLERK     | 7698 | 1981-12-03 |  950.00 |    NULL |     30 |</div><div>|  7902 | FORD   | ANALYST   | 7566 | 1981-12-03 | 3000.00 |    NULL |     20 |</div><div>|  7934 | MILLER | CLERK     | 7782 | 1982-01-23 | 1300.00 |    NULL |     10 |</div><div>+-------+--------+-----------+------+------------+---------+---------+--------+</div><div><br/></div><div>19.列出所有“CLERK”（办事员）的姓名及其部门名称，部门人数</div><div>select</div><div>    d.deptno,d.dname,e.ename</div><div>from</div><div>    emp e</div><div>join</div><div>    dept d</div><div>on</div><div>    e.deptno = d.deptno</div><div>where</div><div>    e.job = 'CLERK';</div><div>t1</div><div>+--------+------------+--------+</div><div>| deptno | dname      | ename  |</div><div>+--------+------------+--------+</div><div>|     10 | ACCOUNTING | MILLER | 3</div><div>|     20 | RESEARCH   | SMITH  | 5</div><div>|     20 | RESEARCH   | ADAMS  | 5</div><div>|     30 | SALES      | JAMES  | 6</div><div>+--------+------------+--------+</div><div><br/></div><div>求出每个部门的员工数量</div><div>select</div><div>    e.deptno,count(e.ename) as totalEmp</div><div>from</div><div>    emp e</div><div>group by</div><div>    e.deptno;</div><div>t2</div><div>+--------+----------+</div><div>| deptno | totalEmp |</div><div>+--------+----------+</div><div>|     10 |        3 |</div><div>|     20 |        5 |</div><div>|     30 |        6 |</div><div>+--------+----------+</div><div><br/></div><div><br/></div><div>select</div><div>    t1.deptno,t1.dname,t1.ename,t2.totalEmp</div><div>from</div><div>    (select</div><div>        d.deptno,d.dname,e.ename</div><div>    from</div><div>        emp e</div><div>    join</div><div>        dept d</div><div>    on</div><div>        e.deptno = d.deptno</div><div>    where</div><div>        e.job = 'CLERK') t1</div><div>join</div><div>    (select</div><div>        e.deptno,count(e.ename) as totalEmp</div><div>    from</div><div>        emp e</div><div>    group by</div><div>        e.deptno) t2</div><div>on</div><div>    t1.deptno = t2.deptno;</div><div><br/></div><div>+--------+------------+--------+----------+</div><div>| deptno | dname      | ename  | totalEmp |</div><div>+--------+------------+--------+----------+</div><div>|     10 | ACCOUNTING | MILLER |        3 |</div><div>|     20 | RESEARCH   | SMITH  |        5 |</div><div>|     20 | RESEARCH   | ADAMS  |        5 |</div><div>|     30 | SALES      | JAMES  |        6 |</div><div>+--------+------------+--------+----------+</div><div><br/></div><div>20.列出最低薪水大于1500的各种工作及从事此工作的全部雇员人数</div><div>第一步：先求出每种工作岗位的最低薪水</div><div>select</div><div>    e.job,min(e.sal) as minsal</div><div>from</div><div>    emp e</div><div>group by</div><div>    e.job;</div><div>+-----------+---------+</div><div>| job       | minsal  |</div><div>+-----------+---------+</div><div>| ANALYST   | 3000.00 |</div><div>| CLERK     |  800.00 |</div><div>| MANAGER   | 2450.00 |</div><div>| PRESIDENT | 5000.00 |</div><div>| SALESMAN  | 1250.00 |</div><div>+-----------+---------+</div><div><br/></div><div>select</div><div>    e.job,min(e.sal) as minsal,count(e.ename) as totalEmp</div><div>from</div><div>    emp e</div><div>group by</div><div>    e.job</div><div>having</div><div>    minsal &gt; 1500;</div><div>+-----------+---------+</div><div>| job       | minsal  |</div><div>+-----------+---------+</div><div>| ANALYST   | 3000.00 |</div><div>| MANAGER   | 2450.00 |</div><div>| PRESIDENT | 5000.00 |</div><div>+-----------+---------+</div><div>+-----------+---------+----------+</div><div>| job       | minsal  | totalEmp |</div><div>+-----------+---------+----------+</div><div>| ANALYST   | 3000.00 |        2 |</div><div>| MANAGER   | 2450.00 |        3 |</div><div>| PRESIDENT | 5000.00 |        1 |</div><div>+-----------+---------+----------+</div><div><br/></div><div><br/></div><div>21.列出在部门“SALES”&lt;销售部&gt;工作的员工的姓名，假定不知道销售部门的部门编号</div><div>select deptno from dept where dname = 'SALES';</div><div>+--------+</div><div>| deptno |</div><div>+--------+</div><div>|     30 |</div><div>+--------+</div><div><br/></div><div><br/></div><div>select ename from emp where deptno = (select deptno from dept where dname = 'SALES');</div><div>+--------+</div><div>| ename  |</div><div>+--------+</div><div>| ALLEN  |</div><div>| WARD   |</div><div>| MARTIN |</div><div>| BLAKE  |</div><div>| TURNER |</div><div>| JAMES  |</div><div>+--------+</div><div><br/></div><div>22.列出薪金高于公司平均薪金的所有员工，所在部门、上级领导、雇员的工资等级</div><div>第一步：求出公司的平均薪水</div><div>select avg(sal) as avgsal from emp;</div><div>+-------------+</div><div>| avgsal      |</div><div>+-------------+</div><div>| 2073.214286 |</div><div>+-------------+</div><div><br/></div><div>select</div><div>    d.dname,</div><div>    e.ename,</div><div>    b.ename as leadername,</div><div>    s.grade</div><div>from</div><div>    emp e</div><div>join</div><div>    dept d</div><div>on</div><div>    e.deptno = d.deptno</div><div>left join</div><div>    emp b</div><div>on</div><div>    e.mgr = b.empno</div><div>join</div><div>    salgrade s</div><div>on</div><div>    e.sal between s.losal and s.hisal</div><div>where</div><div>    e.sal &gt; (select avg(sal) as avgsal from emp);</div><div>+------------+-------+------------+-------+</div><div>| dname      | ename | leadername | grade |</div><div>+------------+-------+------------+-------+</div><div>| RESEARCH   | JONES | KING       |     4 |</div><div>| SALES      | BLAKE | KING       |     4 |</div><div>| ACCOUNTING | CLARK | KING       |     4 |</div><div>| RESEARCH   | SCOTT | JONES      |     4 |</div><div>| ACCOUNTING | KING  | NULL       |     5 |</div><div>| RESEARCH   | FORD  | JONES      |     4 |</div><div>+------------+-------+------------+-------+</div><div><br/></div><div>23.列出与“SCOTT”从事相同工作的所有员工及部门名称</div><div>查询出SCOTT的工作岗位</div><div>select job from emp where ename = 'SCOTT';</div><div>+---------+</div><div>| job     |</div><div>+---------+</div><div>| ANALYST |</div><div>+---------+</div><div><br/></div><div>select</div><div>    d.dname,</div><div>    e.*</div><div>from</div><div>    emp e</div><div>join</div><div>    dept d</div><div>on</div><div>    e.deptno = d.deptno</div><div>where</div><div>    e.job = (select job from emp where ename = 'SCOTT');</div><div>+----------+-------+-------+---------+------+------------+---------+------+--------+</div><div>| dname    | EMPNO | ENAME | JOB     | MGR  | HIREDATE   | SAL     | COMM | DEPTNO |</div><div>+----------+-------+-------+---------+------+------------+---------+------+--------+</div><div>| RESEARCH |  7788 | SCOTT | ANALYST | 7566 | 1987-04-19 | 3000.00 | NULL |     20 |</div><div>| RESEARCH |  7902 | FORD  | ANALYST | 7566 | 1981-12-03 | 3000.00 | NULL |     20 |</div><div>+----------+-------+-------+---------+------+------------+---------+------+--------+</div><div><br/></div><div>24.列出薪金等于部门30中员工的薪金的其它员工的姓名和薪金</div><div>select distinct sal from emp where deptno = 30;</div><div>+---------+</div><div>| sal     |</div><div>+---------+</div><div>| 1600.00 |</div><div>| 1250.00 |</div><div>| 2850.00 |</div><div>| 1500.00 |</div><div>|  950.00 |</div><div>+---------+</div><div><br/></div><div>select ename,sal from emp where sal in(select distinct sal from emp where deptno = 30) and deptno &lt;&gt; 30;</div><div><br/></div><div>25.列出薪金高于在部门30工作的所有员工的薪金的员工姓名和薪金、部门名称</div><div>第一步：先找出部门30的最高薪水</div><div>select max(sal) as maxsal from emp where deptno = 30;</div><div>+---------+</div><div>| maxsal  |</div><div>+---------+</div><div>| 2850.00 |</div><div>+---------+</div><div><br/></div><div>select</div><div>    d.dname,</div><div>    e.ename,</div><div>    e.sal</div><div>from</div><div>    emp e</div><div>join</div><div>    dept d</div><div>on</div><div>    e.deptno = d.deptno</div><div>where</div><div>    e.sal &gt; (select max(sal) as maxsal from emp where deptno = 30);</div><div>+------------+-------+---------+</div><div>| dname      | ename | sal     |</div><div>+------------+-------+---------+</div><div>| ACCOUNTING | KING  | 5000.00 |</div><div>| RESEARCH   | JONES | 2975.00 |</div><div>| RESEARCH   | SCOTT | 3000.00 |</div><div>| RESEARCH   | FORD  | 3000.00 |</div><div>+------------+-------+---------+</div><div><br/></div><div>26.列出在每个部门工作的员工数量、平均工资和平均服务期限</div><div>to_days(日期类型) -&gt; 天数</div><div>获取数据库的系统当前时间的函数是:now()</div><div><br/></div><div>select ename,(to_days(now()) - to_days(hiredate))/365 as serveryear from emp;</div><div>select avg((to_days(now()) - to_days(hiredate))/365) as avgserveryear from emp;</div><div><br/></div><div>select    </div><div>    e.deptno,</div><div>    count(e.ename) as totalEmp,</div><div>    avg(e.sal) as avgsal,</div><div>    avg((to_days(now()) - to_days(hiredate))/365) as avgserveryear</div><div>from</div><div>    emp e</div><div>group by</div><div>    e.deptno;</div><div>+--------+----------+-------------+---------------+</div><div>| deptno | totalEmp | avgsal      | avgserveryear |</div><div>+--------+----------+-------------+---------------+</div><div>|     10 |        3 | 2916.666667 |   34.90503333 |</div><div>|     20 |        5 | 2175.000000 |   32.93206000 |</div><div>|     30 |        6 | 1566.666667 |   35.20365000 |</div><div>+--------+----------+-------------+---------------+</div><div><br/></div><div>27.列出所有员工的姓名、部门名称和工资</div><div>select</div><div>    d.dname,</div><div>    e.ename,</div><div>    e.sal</div><div>from</div><div>    emp e</div><div>right join</div><div>    dept d</div><div>on</div><div>    e.deptno = d.deptno;</div><div>+------------+--------+---------+</div><div>| dname      | ename  | sal     |</div><div>+------------+--------+---------+</div><div>| ACCOUNTING | CLARK  | 2450.00 |</div><div>| ACCOUNTING | KING   | 5000.00 |</div><div>| ACCOUNTING | MILLER | 1300.00 |</div><div>| RESEARCH   | SMITH  |  800.00 |</div><div>| RESEARCH   | JONES  | 2975.00 |</div><div>| RESEARCH   | SCOTT  | 3000.00 |</div><div>| RESEARCH   | ADAMS  | 1100.00 |</div><div>| RESEARCH   | FORD   | 3000.00 |</div><div>| SALES      | ALLEN  | 1600.00 |</div><div>| SALES      | WARD   | 1250.00 |</div><div>| SALES      | MARTIN | 1250.00 |</div><div>| SALES      | BLAKE  | 2850.00 |</div><div>| SALES      | TURNER | 1500.00 |</div><div>| SALES      | JAMES  |  950.00 |</div><div>| OPERATIONS | NULL   |    NULL |</div><div>+------------+--------+---------+</div><div><br/></div><div><br/></div><div>28.列出所有部门的详细信息和人数</div><div>select</div><div>    d.deptno,d.dname,d.loc,count(e.ename) as totalEmp</div><div>from</div><div>    emp e</div><div>right join</div><div>    dept d</div><div>on</div><div>    e.deptno = d.deptno</div><div>group by</div><div>    d.deptno,d.dname,d.loc;</div><div>+--------+------------+----------+----------+</div><div>| deptno | dname      | loc      | totalEmp |</div><div>+--------+------------+----------+----------+</div><div>|     10 | ACCOUNTING | NEW YORK |        3 |</div><div>|     20 | RESEARCH   | DALLAS   |        5 |</div><div>|     30 | SALES      | CHICAGO  |        6 |</div><div>|     40 | OPERATIONS | BOSTON   |        0 |</div><div>+--------+------------+----------+----------+</div><div><br/></div><div>29.列出各种工作的最低工资及从事此工作的雇员姓名</div><div>select</div><div>    e.job,min(e.sal) as minsal</div><div>from</div><div>    emp e</div><div>group by</div><div>    e.job;</div><div>+-----------+---------+</div><div>| job       | minsal  |</div><div>+-----------+---------+</div><div>| ANALYST   | 3000.00 |</div><div>| CLERK     |  800.00 |</div><div>| MANAGER   | 2450.00 |</div><div>| PRESIDENT | 5000.00 |</div><div>| SALESMAN  | 1250.00 |</div><div>+-----------+---------+</div><div><br/></div><div>将以上查询结果当成临时表t(job,minsal)</div><div>select</div><div>    e.ename</div><div>from</div><div>    emp e</div><div>join</div><div>    (select</div><div>        e.job,min(e.sal) as minsal</div><div>    from</div><div>        emp e</div><div>    group by</div><div>        e.job) t</div><div>on</div><div>    e.job = t.job</div><div>where</div><div>    e.sal = t.minsal;</div><div><br/></div><div>+--------+</div><div>| ename  |</div><div>+--------+</div><div>| SMITH  |</div><div>| WARD   |</div><div>| MARTIN |</div><div>| CLARK  |</div><div>| SCOTT  |</div><div>| KING   |</div><div>| FORD   |</div><div>+--------+</div><div><br/></div><div>30.列出各个部门MANAGER的最低薪金</div><div><br/></div><div>select</div><div>    e.deptno,min(e.sal) as minsal</div><div>from</div><div>    emp e</div><div>where</div><div>    e.job = 'MANAGER'</div><div>group by</div><div>    e.deptno;</div><div>+--------+---------+</div><div>| deptno | minsal  |</div><div>+--------+---------+</div><div>|     10 | 2450.00 |</div><div>|     20 | 2975.00 |</div><div>|     30 | 2850.00 |</div><div>+--------+---------+</div><div><br/></div><div>31.列出所有员工的年工资，按年薪从低到高排序</div><div>select ename,(sal+ifnull(comm,0))*12 as yearsal from emp order by yearsal asc;</div><div>+--------+----------+</div><div>| ename  | yearsal  |</div><div>+--------+----------+</div><div>| SMITH  |  9600.00 |</div><div>| JAMES  | 11400.00 |</div><div>| ADAMS  | 13200.00 |</div><div>| MILLER | 15600.00 |</div><div>| TURNER | 18000.00 |</div><div>| WARD   | 21000.00 |</div><div>| ALLEN  | 22800.00 |</div><div>| CLARK  | 29400.00 |</div><div>| MARTIN | 31800.00 |</div><div>| BLAKE  | 34200.00 |</div><div>| JONES  | 35700.00 |</div><div>| FORD   | 36000.00 |</div><div>| SCOTT  | 36000.00 |</div><div>| KING   | 60000.00 |</div><div>+--------+----------+</div><div><br/></div><div>32.求出员工领导的薪水超过3000的员工名称和领导名称</div><div><br/></div><div>select</div><div>    e.ename,</div><div>    b.ename as leadername</div><div>from</div><div>    emp e</div><div>join</div><div>    emp b</div><div>on</div><div>    e.mgr = b.empno</div><div>where</div><div>    b.sal &gt; 3000;</div><div>+-------+------------+</div><div>| ename | leadername |</div><div>+-------+------------+</div><div>| JONES | KING       |</div><div>| BLAKE | KING       |</div><div>| CLARK | KING       |</div><div>+-------+------------+</div><div><br/></div><div>33.求部门名称中带“S”字符的部门员工的工资合计、部门人数</div><div>select</div><div>    d.dname,</div><div>    sum(e.sal) as sumsal,</div><div>    count(e.ename) as totalEmp</div><div>from</div><div>    emp e</div><div>join</div><div>    dept d</div><div>on</div><div>    e.deptno = d.deptno</div><div>where</div><div>    d.dname like '%s%'</div><div>group by</div><div>    d.dname;</div><div>+----------+----------+----------+</div><div>| dname    | sumsal   | totalEmp |</div><div>+----------+----------+----------+</div><div>| RESEARCH | 10875.00 |        5 |</div><div>| SALES    |  9400.00 |        6 |</div><div>+----------+----------+----------+</div><div><br/></div><div>34.给任职日期超过30年的员工加薪10%</div><div>update emp_bak1 set sal = sal * 1.1 where (to_days(now()) - to_days(hiredate))/365 &gt; 30;</div></span>
</div></body></html> 