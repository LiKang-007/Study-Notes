<html>
<head>
  <title>Elasticsearch环境</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/602916 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="5842"/>
<h1>Elasticsearch环境</h1>

<div>
<span><div><span style="font-size: 14pt; font-weight: bold;"> 一、相关概念</span></div><div><br/></div><div><span style="font-size: 12pt; font-weight: bold;">    1、单机&amp;集群</span></div><div>        单台Elasticsearch服务器提供服务，往往都有最大的负载能力，超过这个阈值，服务器性能就会大大降低甚至不可用，所以生产环境中，一般都是运行在指定服务器集群中。</div><div>        除了负载能力，单点服务器也存在其它问题：</div><div>            1》单台机器存储容量有限</div><div>            2》单台服务器容易出现单点故障，无法实现高可用</div><div>            3》单台服务器的并发处理能力有限</div><div>        配置服务器集群时，集群中节点数量没有限制，大于等于2个节点就可以看做是集群了。一般出于高性能以及高可用性方面来考虑集群中节点的数量都是3个以上。</div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">    2、集群Cluster</span><span style="font-size: 12pt; font-weight: bold;">  </span></font>  </div><div>        一个集群就是由一个或者多个服务器节点组织在一起，共同持有整个数据，并一起提供索引和搜索功能。一个Elasticsearch集群有一个唯一的名字标识，这个名字默认就是“elasticsearch”。这个名字是重要的，因为一个节点只能通过指定某个集群的名字，来加入这个集群。</div><div><span style="font-size: 12pt; font-weight: bold;">    3、节点Node</span></div><div>        集群中包含很多服务器，一个节点就是其中一个服务器（一般一台机器启动一个ES服务，故一个节点对应一个服务器）。作为集群的一部分，它存储数据，参与集群的索引和搜索功能。</div><div>        一个节点也是由一个名字来标识的，默认情况下，这个名字是一个随机的漫威漫画角色的名字，这个名字会在启动的时候赋予节点。这个名字对于管理工作来说挺重要的，因为在这个管理过程中，要去确定网络中的哪些服务器对应于Elasticsearch集群中的哪些节点。</div><div>        一个节点可以通过配置集群名称的方式来加入一个指定的集群。默认情况下，每个节点都会被安排加入到一个叫</div><div>做“elasticsearch”的集群中，这意味着，如果在你的网络中启动了若干个节点，并假定它们能够互相发现彼此，它们会自动的形成并且加入到一个叫做“elasticsearch”的集群中。</div><div><br/></div><div><span style="font-size: 14pt; font-weight: bold;">二、Windows集群</span></div><div>  <span style="font-size: 12pt; font-weight: bold;">  部署集群</span></div><div>        就是将ES压缩包分别解压到三个不同的文件夹。分别修改配置文件，并启动服务，使其成为集群。</div><div>修改配置文件（/config/elasticsearch.yml）</div><div>  <span style="color: rgb(255, 0, 0); font-weight: bold;">  注意：配置文件参数“:”后面一定要加空格。</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>#集群名称</div><div>cluster.name: myCluster</div><div>#节点名称</div><div>node.name: node1</div><div>#主节点</div><div>node.master: true</div><div>#数据节点</div><div>node.data: true</div><div><br/></div><div><br/></div><div>#ip名称</div><div>network.host: localhost</div><div>#http端口</div><div>http.port: 1001</div><div>#tcp监听端口</div><div>transport.tcp.port: 9301</div><div><br/></div><div><br/></div><div>#跨域配置</div><div>http.cors.enabled: true</div><div>http.cors.allow-origin: &quot;*&quot;</div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font face="Monaco">查看集群状态</font></div><div><font face="Monaco">GET请求：http://localhost:1001/_cluster/health</font></div><div><font face="Monaco"><br/></font></div></div><div>后加入的节点需要配置查找模块</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>#集群名称</div><div>cluster.name: myCluster</div><div>#节点名称</div><div>node.name: node1</div><div>#主节点</div><div>node.master: true</div><div>#数据节点</div><div>node.data: true</div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div>#ip名称</div><div>network.host: localhost</div><div>#http端口</div><div>http.port: 1002</div><div>#tcp监听端口</div><div>transport.tcp.port: 9302</div><div><br/></div><div>#查找模块</div><div>discovery.seed_hosts: [&quot;localhost:9301&quot;]</div><div>discovery.zen.fd.ping_timeout: 1m</div><div>discovery.zen.fd.ping_retries: 5</div><div><br/></div><div><br/></div><div><br/></div><div>#跨域配置</div><div>http.cors.enabled: true</div><div>http.cors.allow-origin: &quot;*&quot;</div></div><div><br/></div><div><span style="font-size: 14pt; font-weight: bold;">三、linux集群</span></div><div>    <span style="font-size: 12pt; font-weight: bold;">3、1 linux单点</span><img src="Elasticsearch环境_files/Image.png" type="image/png" data-filename="Image.png"/></div><div><img src="Elasticsearch环境_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div><img src="Elasticsearch环境_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>cluster.name: elasticsearch</div><div>node.name: node-1</div><div>network.host: 0.0.0.0</div><div>http.port: 9200</div><div>cluster.initial_master_nodes: [&quot;node-1&quot;]</div></div><div><img src="Elasticsearch环境_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>es soft nofile 65536</div><div>es hard nofile 65536</div></div><div><img src="Elasticsearch环境_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div><img src="Elasticsearch环境_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div><span>    </span>（再次执行上面的更改ES文件所有者操作：chown -R es:es /opt/module/es）</div><div><span style="font-size: 12pt; font-weight: bold;">3、2 linux集群</span></div><div><img src="Elasticsearch环境_files/Image [6].png" type="image/png" data-filename="Image.png"/></div><div><img src="Elasticsearch环境_files/Image [7].png" type="image/png" data-filename="Image.png"/></div><div><img src="Elasticsearch环境_files/Image [8].png" type="image/png" data-filename="Image.png"/></div><div><img src="Elasticsearch环境_files/Image [9].png" type="image/png" data-filename="Image.png"/></div><div><img src="Elasticsearch环境_files/Image [10].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><img src="Elasticsearch环境_files/Image [11].png" type="image/png" data-filename="Image.png"/></div><div><img src="Elasticsearch环境_files/Image [12].png" type="image/png" data-filename="Image.png"/></div><div><img src="Elasticsearch环境_files/Image [13].png" type="image/png" data-filename="Image.png"/></div><div><img src="Elasticsearch环境_files/Image [14].png" type="image/png" data-filename="Image.png"/> </div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>Elasticsearch集群：</div><div>    1、集群宕机只剩一个节点（不管剩下的是不是master节点），不会一直选取（master），集群也不能访问。</div><div><br/></div></div><div><br/></div><div><br/></div></span>
</div></body></html> 