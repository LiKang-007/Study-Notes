<html>
<head>
  <title>SpringMVC核心技术</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/602916 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="2970"/>
<h1>SpringMVC核心技术</h1>

<div>
<span><div><span style="font-weight: bold; font-size: 14pt;">一、请求转发和重定向</span></div><div><img src="SpringMVC核心技术_files/Image.png" type="image/png" data-filename="Image.png"/></div><div><img src="SpringMVC核心技术_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div>ModelAndView mv=new ModelAndView();</div><div>以前SpringMVC跳转到 jsp</div><div>mv.setViewName(&quot;/show&quot;); ，这种方式可以使用视图解析器</div><div><br/></div><div><span style="font-weight: bold;">显示转发</span></div><div><span style="font-weight: bold;">语法：</span></div><div>mv.setViewName(&quot;forward:视图文件完整路径名&quot;);</div><div><span style="font-weight: bold;">特点：</span>不能和视图解析器一同使用，就当项目没有视图解析器。必须使用完整路经名。</div><div><span style="font-weight: bold;">显示转发的应用场景：访问视图解析器之外的目录。</span></div><div><br/></div><div><span style="font-weight: bold;">转发行为因为是在服务器内部的访问，故可以访问WEB-INF下的资源。</span></div><div><br/></div><div><span style="font-weight: bold;">重定向redirect</span></div><div><span style="font-weight: bold;">语法：</span></div><div>mv.setViewName(&quot;redirect:视图文件完整路径名&quot;);</div><div><span style="font-weight: bold;">特点：1、</span>不能和视图解析器一同使用，就当项目没有视图解析器。必须使用完整路经名。</div><div>          <span style="font-weight: bold;">2</span>、不能使用访问WEB-INF下的资源。</div><div><span style="font-weight: bold;">框架对重定向的操作：</span>框架会将第一次请求的request作用域中的简单数据作为第二次请求时的请求参数使用。</div><div><span style="font-weight: bold;">可以作为两次请求之间的数据通道使用，第二次请求可以读取浏览器访问时的参数。</span></div><div><span style="font-weight: bold;">${param.参数名}</span></div><div><span style="font-weight: bold;"><br/></span></div><div><span style="font-weight: bold; font-size: 14pt;">二、异常处理</span></div><div><span style="font-weight: bold;"><img src="SpringMVC核心技术_files/Image [2].png" type="image/png" data-filename="Image.png"/></span></div><div><span style="font-weight: bold; font-size: 11pt;">SpringMVC采用统一全局异常处理。</span></div><div><span style="font-size: 14.6667px;"><b>把所有controller中的所有异常处理都集中到一个地方。采用的是aop的思想。把业务逻辑和异常处理代码分离开。解耦和。</b></span></div><div><span style="font-size: 14.6667px;"><b>使用两个注解：</b></span></div><div><span style="font-size: 14.6667px;"><b><span>    1、@ExceptionHandler</span></b></span></div><div><span style="font-size: 14.6667px;"><b><span>    2、@ControllerAdvice</span><br/></b></span><span style="font-size: 11pt;"><b><img src="SpringMVC核心技术_files/Image [3].png" type="image/png" data-filename="Image.png"/></b></span></div><div><span style="font-size: 11pt;"><b><br/></b></span></div><div><span style="font-size: 11pt;"><b><img src="SpringMVC核心技术_files/Image [4].png" type="image/png" data-filename="Image.png"/></b></span></div><div><b><font style="font-size: 14pt;">三、拦截器</font></b></div><div><b><span style="font-size: 18.6667px;">   <font style="font-size: 11pt;"> </font></span><font style="font-size: 11pt;">可以看成是多个Controller中公用的功能，集中到拦截器统一处理，使用的是aop思想。</font></b></div><div><span style="font-size: 14pt;"><b><img src="SpringMVC核心技术_files/Image [5].png" type="image/png" data-filename="Image.png"/></b></span></div><div><span style="font-size: 14pt;"><b><img src="SpringMVC核心技术_files/Image [6].png" type="image/png" data-filename="Image.png"/></b></span></div><div><b><font style="font-size: 12pt;">SpringMVC  </font></b></div><div><b><font style="font-size: 12pt;">4.3版本中，HandlerInterceptor接口的三个方法必须全部实现。</font></b></div><div><b><font style="font-size: 12pt;">5.2.5版本中，该三个方法被default修饰，需要使用那个就实现哪个。</font></b></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><b>package com.handler;</b></div><div><b><br/></b></div><div><b><br/></b></div><div><b>import org.springframework.web.servlet.HandlerInterceptor;</b></div><div><b>import org.springframework.web.servlet.ModelAndView;</b></div><div><b><br/></b></div><div><b><br/></b></div><div><b>import javax.servlet.http.HttpServletRequest;</b></div><div><b>import javax.servlet.http.HttpServletResponse;</b></div><div><b><br/></b></div><div><b><br/></b></div><div><b>public class OneInterceptor implements  HandlerInterceptor {</b></div><div><b>    /*</b></div><div><b>        preHandle叫做预处理方法</b></div><div><b>            参数：</b></div><div><b>                object handler：被拦截的控制器对象</b></div><div><b>            返回值：boolean</b></div><div><b>               true：表示请求通过了拦截器的拦截，可以执行处理器方法。</b></div><div><b>               false：表示请求没有通过拦截器的验证，请求到达拦截器就截止了。controller对象没有被处理。</b></div><div><b>            特点：</b></div><div><b>                1、方法在控制器方法之前先执行，用户的请求首先到达此方法</b></div><div><b>                2、在这个方法中可以获取请求的信息，验证请求是否符合要求。</b></div><div><b>                    例如；验证用户是否可以登录，验证用户权限是否可以访问某个URL</b></div><div><b>                   如果验证失败，可以截断请求，请求不能被处理。</b></div><div><b>                   如果验证成功，可以放行请求，此时控制器方法才能执行。</b></div><div><b>     * */</b></div><div><b>    @Override</b></div><div><b>    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {</b></div><div><b><br/></b></div><div><b><br/></b></div><div><b>        return false;</b></div><div><b>    }</b></div><div><b>    /*</b></div><div><b>          postHandle:后处理方法，十分重要，是项目的入口和门户</b></div><div><b>          参数：</b></div><div><b>             Object handler:被拦截的处理器对象</b></div><div><b>             ModelAndView modelAndView:处理器方法的返回值</b></div><div><b>          特点：</b></div><div><b>            1、在处理器方法执行之后执行</b></div><div><b>            2、能够获取到处理方法的返回值ModelAndView，可以修改ModelAndView中的数据和视图，可以影响到最后的执行结果。</b></div><div><b>            3、主要是可以对原来的执行结果做二次修正</b></div><div><b><br/></b></div><div><b><br/></b></div><div><b>    **/</b></div><div><b>    @Override</b></div><div><b>    public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception {</b></div><div><b><br/></b></div><div><b><br/></b></div><div><b>    }</b></div><div><b>    /*</b></div><div><b>        afterCompletion:最后执行的方法</b></div><div><b>        参数：</b></div><div><b>             Object handler:被拦截的处理器对象</b></div><div><b>             Exception ex:程序中发生的异常</b></div><div><b>        特点：</b></div><div><b>            1、在请求处理完成后执行，框架中规定视图处理完成后，对视图执行了forward，就认为是请求处理完成</b></div><div><b>            2、一般是做资源回收工作的，程序中创建了一些对象，在这里可以删除，把占用的内存回收</b></div><div><b>    * */</b></div><div><b>    @Override</b></div><div><b>    public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception {</b></div><div><b><br/></b></div><div><b><br/></b></div><div><b>    }</b></div><div><b>}</b></div></div><div><span style="font-size: 16px;"><b>声明拦截器</b></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 16px;">&lt;!--声明拦截器：拦截器可以有0个或者多个--&gt;</span></div><div><span style="font-size: 16px;">&lt;mvc:interceptors&gt;</span></div><div><span style="font-size: 16px;">    &lt;!--声明第一个拦截器--&gt;</span></div><div><span style="font-size: 16px;">    &lt;mvc:interceptor&gt;</span></div><div><span style="font-size: 16px;">        &lt;!--指定被拦截的请求URL，</span></div><div><span style="font-size: 16px;">            可以使用通配符**，表示任意的字符，文件或者多级目录和目录中的文件--&gt;</span></div><div><span style="font-size: 16px;">        &lt;!-- &lt;mvc:mapping path=&quot;/**&quot;/&gt;表示所有的请求都将被拦截--&gt;</span></div><div><span style="font-size: 16px;">        &lt;mvc:mapping path=&quot;/student/**&quot;/&gt;</span></div><div><span style="font-size: 16px;">        &lt;!--声明拦截器对象--&gt;</span></div><div><span style="font-size: 16px;">        &lt;bean class=&quot;com.handler.OneInterceptor&quot;/&gt;</span></div><div><span style="font-size: 16px;">    &lt;/mvc:interceptor&gt;</span></div><div><span style="font-size: 16px;">&lt;/mvc:interceptors&gt;</span></div></div><div><span style="font-size: 16px;"><br/></span></div><div><span style="font-size: 16px;"><b>多个拦截器</b></span></div><div><span style="font-size: 16px;"><span>    在框架中保存多个拦截器是ArrayList，按照声明的先后顺序放入到ArrayList，先声明的先进行拦截</span><br/></span></div><div><span style="font-size: 12pt;"><img src="SpringMVC核心技术_files/Image [7].png" type="image/png" data-filename="Image.png"/></span></div><div><span style="font-size: 12pt;"><img src="SpringMVC核心技术_files/Image [8].png" type="image/png" data-filename="Image.png"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div>拦截器和过滤器的区别</div><div><span style="font-size: 12pt;"><img src="SpringMVC核心技术_files/Image [9].png" type="image/png" data-filename="Image.png"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div>登录验证拦截器实现</div><div><br/></div></span>
</div></body></html> 