<html>
<head>
  <title>Docker Compose</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/602916 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="5550"/>
<h1>Docker Compose</h1>

<div>
<span><div><span style="font-size: 12pt; font-weight: bold;">简介：</span></div><div>Docker</div><div>DcoekrFile build run 手动操作，每次操作单个容器！</div><div>微服务。100个微服务！依赖关系！</div><div><br/></div><div>Docker Compose来轻松高效的管理容器！定义运行多个容器！</div><div><br/></div><div><span style="font-size: 12pt; font-weight: bold;">官方介绍：</span></div><div><span style="font-size: 12pt;">   </span> <span style="font-size: 11pt;">1、定义、运行 多个容器；</span></div><div><span style="font-size: 11pt;">    2、YAML file配置文件</span></div><div><span style="font-size: 11pt;">    3、single command。命令</span></div><div><br/></div><div><span style="font-size: 16px;"><span style="font-size: 16px; font-weight: bold;">三步骤：</span></span></div><div><span style="font-size: 16px;">    1、Dockerfile</span></div><div><span style="font-size: 16px;">    2、docker-compose.yml</span></div><div><span style="font-size: 16px;">    3、docker-compose up 启动项目</span></div><div><br/></div><div><span style="font-size: 16px;"><span style="font-size: 16px; font-weight: bold;">作用：批量容器编排</span></span></div><div><span style="font-size: 16px;"><br/></span></div><div><span style="font-size: 16px;">    注：</span></div><div><span style="font-size: 16px;">        1、Compose是Docker官方的开源项目。需要安装！</span></div><div><span style="font-size: 16px;">        2、Compose的重要概念：</span></div><div><span style="font-size: 16px;">                1、服务services，容器（单个）。</span></div><div><span style="font-size: 16px;">                2、项目project（一组关联的容器）。</span></div><div><span style="font-size: 12pt;"><img src="Docker Compose_files/Image.png" type="image/png" data-filename="Image.png"/></span></div><div><span style="font-size: 12pt;">    </span></div><div><span style="font-size: 16px;"><span style="font-size: 16px; font-weight: bold;">Compose安装：</span></span></div><div><span style="font-size: 16px;">    1、下载</span></div><div><span style="font-size: 12pt;"><img src="Docker Compose_files/Image [1].png" type="image/png" data-filename="Image.png"/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>sudo curl -L https://github.com/docker/compose/releases/download/1.17.1/docker/compose-`uname -s`-`uname -m` &gt;/usr/local/bin/docker-compose</div><div><br/></div><div>sudo curl -L https://get.daocloud.io/docker/compose/releases/download/1.25.1/docker-compose-`uname -s`-`uname -m` -o /usr/local/bin/docker-compose</div><div><br/></div><div><br/></div></div><div><span style="font-size: 12pt;">    2、授权</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>sudo chmod +x /usr/local/bin/docker-compose</div></div><div>     3、验证</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>docker-compose version</div></div><div><span style="font-size: 12pt;">  </span></div><div><span style="font-size: 16px;">体验：</span></div><div><span style="font-size: 16px;">    地址：https://docs.docker.com/compose/gettingstarted/</span></div><div><br/></div><div><span style="font-size: 12pt;">    1、应用 app.py</span></div><div><span style="font-size: 12pt;">    2、Dockerfile 应用打包为镜像</span></div><div><span style="font-size: 12pt;">    3、 Docker-compose yaml 文件（定义整个服务，需要的环境）</span></div><div><span style="font-size: 12pt;">    4、启动compose项目（docker-compose up）</span></div><div><span style="font-size: 12pt;">    </span></div><div><span style="font-size: 12pt;">   </span> <span style="font-size: 12pt; font-weight: bold;">流程</span><span style="font-size: 12pt;">：</span></div><div><span style="font-size: 12pt;">        1、创建网络；</span></div><div><span style="font-size: 12pt;">        2、执行Docker-compose yaml；</span></div><div><span style="font-size: 12pt;">        3、启动服务。</span></div><div><br/></div><div><span style="font-size: 12pt;">    默认的服务名：</span></div><div><span style="font-size: 12pt;">        文件名_服务名_num </span></div><div><span style="font-size: 12pt;">    网络规则：</span></div><div><span style="font-size: 12pt;">        项目中所有的服务，compose为它们创建了一个网络。（在同一个网络下，可以直接通过域名访问，高可用，比如这个容器重新启动IP变了，但是是通过域名访问的仍然可以访问到</span><span style="font-size: 12pt; color: unset; font-family: unset;">）</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; color: unset; font-family: unset;">   </span> <span style="font-size: 12pt; color: unset; font-family: unset; font-weight: bold;">停止</span><span style="font-size: 12pt; color: unset; font-family: unset;">：1、docker-compose down（需要在compose yml文件所在的目录下运行命令）</span></div><div><span style="font-size: 12pt; color: unset; font-family: unset;">              2、ctrl+c</span></div><div><br/></div><div><span style="font-size: 14pt; font-weight: bold;">Compose配置编写规则</span></div><div><span style="font-size: 16px;">    </span></div><div><span style="font-size: 16px;">地址：https://docser.com/compose/compose-file/#compose-file-structure-and-examples</span></div><div><span style="font-size: 16px;"><br/></span></div><div><span style="font-size: 16px;">  docker-compose.yml 只有三层</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>#3层</div><div><br/></div><div>version: '' <font color="#E30000">#版本</font></div><div>services:   <font color="#FF0000">#服务</font></div><div>    服务1: web</div><div>    #服务配置</div><div>    images</div><div>    builds</div><div>    network</div><div>    服雾2: redis</div><div>    #服务配置</div><div>    。。。</div><div>    。。。</div><div>    服务n: </div><div><br/></div><div><font color="#E30000">#其他配置</font> 网络/卷、全局规则</div><div><br/></div><div><br/></div></div><div><span style="font-size: 16px;">version （向下兼容）需要根据docker引擎确定，可查询官方文档。</span></div><div><span style="font-size: 16px;"><br/></span></div><div><span style="font-size: 16px;">    具体命令可查询官方文档查询：</span></div><div><span style="font-size: 16px;">        下面是一些比较重要的命令:</span></div><div><span style="font-size: 16px;">            1、depends_on （确定服务之间的启动的先后顺序）</span></div><div><br/></div><div><font style="font-size: 11pt;"><span style="font-size: 11pt; color: rgb(51, 51, 51); font-family: Monaco; font-weight: bold;">实战：一键部署WP博客</span></font></div><div><span style="font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco;">地址：https://docs.docker.com/compose/wordpress</span></div><div><span style="font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco;">根据官网步骤。</span></div><div><br/></div><div><span style="font-size: 11pt;">实战：自己写微服务上线</span></div><div><span style="font-size: 16px;"><br/></span></div><div><span style="font-size: 16px;">假设项目要重新部署打包：</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>dicker-compose up --build #重新构建</div></div><div><span style="font-size: 16px;">    </span></div><div><span style="font-size: 16px;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>version: '3.5'</div><div>services:</div><div>  web1:</div><div>    image: springboot:1.0</div><div>    ports:</div><div>      - '8081:8080'</div><div>  web2:</div><div>    image: springboot:1.0</div><div>    ports:</div><div>      - '8082:8080'</div><div>  web3:</div><div>    image: springboot:1.0</div><div><br/></div><div><br/></div><div>    ports:</div><div>      - '8083:8080'</div><div>networks:</div><div>  default:</div><div>    external: true</div><div>    name: mynet</div></div><div><span style="font-size: 16px;"><br/></span></div><div><span style="font-size: 16px;"><br/></span></div><div><br/></div></span>
</div></body></html> 