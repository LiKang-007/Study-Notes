<html>
<head>
  <title>作业</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/602916 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="5774"/>
<h1>作业</h1>

<div>
<span><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>作业一：暴露端口的重要性</div><div>作业二：官方测试以及如何进入容器查看的重要性</div><div>作业三：查看容器的存活状态</div></div><div><span style="font-size: 14pt;"><br/></span></div><div><span style="font-size: 14pt; font-weight: bold;">作业一：部署Nginx</span></div><div>   </div><div>    <span style="font-size: unset; color: unset; font-family: unset;"> 步骤：</span></div><div>            1、搜索镜像；search 建议去docker搜索，可以看到帮助文档</div><div>            2、下载镜像；pull</div><div>            3、运行测试；docker run -d --name nginx01 -p 3344:80 nginx</div><div>                    -d    代表后台运行；</div><div>                    --name     给容器命名；</div><div>                    -p     宿主机端口：容器内部端口</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>[root@192 likang]# docker run -d --name nginx01 -p 3344:80 nginx</div><div>87c4962aa2748873f64e4683e086b8620a7be34aec31d7224ddd36bb47c028a1</div><div>[root@192 likang]# docker ps</div><div>CONTAINER ID   IMAGE     COMMAND                  CREATED          STATUS         PORTS                                   NAMES</div><div>87c4962aa274   nginx     &quot;/docker-entrypoint.…&quot;   14 seconds ago   Up 8 seconds   0.0.0.0:3344-&gt;80/tcp, :::3344-&gt;80/tcp   nginx01</div><div>[root@192 likang]# docker ps</div><div>CONTAINER ID   IMAGE     COMMAND                  CREATED          STATUS          PORTS                                   NAMES</div><div>87c4962aa274   nginx     &quot;/docker-entrypoint.…&quot;   51 seconds ago   Up 44 seconds   0.0.0.0:3344-&gt;80/tcp, :::3344-&gt;80/tcp   nginx01</div><div>[root@192 likang]# curl localhost:3344</div><div>&lt;!DOCTYPE html&gt;</div><div>&lt;html&gt;</div><div>&lt;head&gt;</div><div>&lt;title&gt;Welcome to nginx!&lt;/title&gt;</div><div>&lt;style&gt;</div><div>    body {</div><div>        width: 35em;</div><div>        margin: 0 auto;</div><div>        font-family: Tahoma, Verdana, Arial, sans-serif;</div><div>    }</div><div>&lt;/style&gt;</div><div>&lt;/head&gt;</div><div>&lt;body&gt;</div><div>&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;</div><div>&lt;p&gt;If you see this page, the nginx web server is successfully installed and</div><div>working. Further configuration is required.&lt;/p&gt;</div><div><br/></div><div><br/></div><div>&lt;p&gt;For online documentation and support please refer to</div><div>&lt;a href=&quot;http://nginx.org/&quot;&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;</div><div>Commercial support is available at</div><div>&lt;a href=&quot;http://nginx.com/&quot;&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;</div><div><br/></div><div><br/></div><div>&lt;p&gt;&lt;em&gt;Thank you for using nginx.&lt;/em&gt;&lt;/p&gt;</div><div>&lt;/body&gt;</div><div>&lt;/html&gt;</div><div>[root@192 likang]#</div><div><br/></div></div><div>                4、进入容器</div><div>                    docker exec -it nginx01 /bin/bash</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>[root@192 likang]# docker exec -it nginx01 /bin/bash</div><div>root@87c4962aa274:/# whereis nginx</div><div>nginx: /usr/sbin/nginx /usr/lib/nginx /etc/nginx /usr/share/nginx</div><div>root@87c4962aa274:/# ls</div><div>bin   dev           docker-entrypoint.sh  home  lib64  mnt  proc  run   srv  tmp  var</div><div>boot  docker-entrypoint.d  etc             lib   media  opt  root  sbin  sys  usr</div><div>root@87c4962aa274:/# cd etc/nginx</div><div>root@87c4962aa274:/etc/nginx# ls</div><div>conf.d    fastcgi_params    mime.types  modules  nginx.conf  scgi_params  uwsgi_params</div><div>root@87c4962aa274:/etc/nginx#</div><div><br/></div><div><br/></div><div><br/></div></div><div><br/></div><div>        端口暴露：</div><div><img src="作业_files/Image.png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>思考问题：每次改动nginx配置文件，都需要进入容器内部？十分麻烦，要是可以在容器外边提供一个映射路径，达到在外部修改文件名，容器内部就可以自动修改？</div><div><br/></div><div><br/></div><div><span style="font-size: 14pt; font-weight: bold;">    作业二：部署Tomcat</span></div><div>        官方的方法：</div><div>            docker run -it --rm tomcat:9.0</div><div>        #我们之前的启动都是后台启动，停止了容器，容器还可以查到， docker run -it --rm，一般用来测试，用完就删（删除容器）。</div><div>        #推荐先下载在启动</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>#下载</div><div>docker pull tomcat</div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">#启动</span></div><div><font face="Monaco">docker run -d -p3355:8080 --name tomcat01 tomcat</font></div><div><font face="Monaco">#测试访问</font></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">40</span><span style="font-family: Monaco; font-size: 9pt;">4</span></div><div><span style="font-family: Monaco; font-size: 9pt;">#访问测试没有问题</span></div><div><span style="font-family: Monaco; font-size: 9pt;">#进入容器</span></div><div><font face="Monaco">docker exec -it tomcat01 /bin/bash</font></div><div><font face="Monaco">#发现问题：1、Linux命令少了，2、没有webapps，阿里云镜像的原因。默认是最小的镜像，所有不必要都剔除了，保证最小的可运行环境。</font></div><div><font face="Monaco">#将webapps.dist下所有的东西拷贝到 webapps下</font></div><div><font face="Monaco">cp -r  webapps.dist/ * webapps</font></div><div><font face="Monaco"><br/></font></div></div><div><br/></div><div>思考问题：部署项目，如果每次都需要进入容器十分的麻烦？要是在容器外部提供一个映射路径，在外部放置项目，自动同步的容器内部就好了。</div><div><br/></div><div><span style="font-size: 14pt; font-weight: bold;">作业三：部署es+kibana</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>#es 暴露的端口很多</div><div>#es 十分耗内存</div><div><font face="Monaco">#es 的数据一般需要放置到安全目录！挂载</font></div><div><font face="Monaco">#  --net somenetwork ? 网络配置</font></div><div><br/></div><div>#启动</div><div>docker run -d --name elasticsearch  -p 9200:9200 -p 9300:9300 -e &quot;discovery.type=single-node&quot; elasticsearch:7.6.1</div><div><br/></div><div>#启动了发现非常卡（es非常耗费内存，windows单机需要1.5内存）</div><div><br/></div><div>#docker stats 查看cpu的状态</div><div><br/></div><div>#一般云服务器学生机是1核2G！</div><div><br/></div><div>#测试es是否成功</div><div>curl localhost:9200</div><div>#关闭es，增加内存的限制</div><div>#修改配置文件 -e 环境配置修改</div><div>docker run -d --name elasticsearch  -p 9200:9200 -p 9300:9300 -e &quot;discovery.type=single-node&quot; -e ES_JAVA_OPTS=&quot;-Xms64m -Xmx512m&quot; elasticsearch:7.6.1</div><div><br/></div><div>#-e ES_JAVA_OPTS=&quot;-Xms64m -Xmx512m&quot; 设置JVM最大512m内存</div></div><div><img src="作业_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div>设置为512m发现es启动不了了。</div><div>增加参数后：</div><div><img src="作业_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>使用kibana连接es</div><div><img src="作业_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></span>
</div></body></html> 